
<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Background Theory &mdash; SimPEG 0.15.2 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-rendered-html.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/logo-block.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="API" href="api_VRM.html" />
    <link rel="prev" title="Viscous Remanent Magnetization" href="index.html" />
 

<meta name="description" content="Simulation and Parameter Estimation in Geophysics">
<meta name="author" content="SimPEG Developers">
<meta name="keywords" content="python, geophysics, inversion, electromagnetics, magnetotellurics, magnetics, gravity, DC, flow inverse problems, open source, finite volume">


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-45185336-1', 'auto');
  ga('send', 'pageview');

</script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> SimPEG
          </a>
              <div class="version">
                0.15.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../basic/big_picture.html">Why SimPEG?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic/contributing.html">Contributing to SimPEG</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic/installing.html">Getting Started with SimPEG</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic/getting_started_developers.html">Getting Started: for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic/practices.html">Practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Gallery</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/01-models_mapping/index.html">Models and Mapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/02-linear_inversion/index.html">Linear Problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/03-gravity/index.html">Gravity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/04-magnetics/index.html">Magnetics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/05-dcr/index.html">Direct Current Resistivity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/06-ip/index.html">Induced Polarization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/07-fdem/index.html">Frequency-Domain Electromagnetics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/08-tdem/index.html">Time-Domain Electromagnetics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/09-nsem/index.html">Natural Source Electromagnetics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/10-vrm/index.html">Viscous Remanent Magnetization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/11-flow/index.html">Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/12-seismic/index.html">Seismic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/13-pgi/index.html">PGI: Petrophysically and Geologically Guided Geophysical Inversion</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Packages</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../em/index.html">Electromagnetics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dc/index.html">Direct Current Resistivity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ip/index.html">Induced Polarization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pf/index.html">Potential Fields</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Viscous Remanent Magnetization</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Background Theory</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#general">General</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dispersive-magnetic-susceptibility">Dispersive Magnetic Susceptibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="#numerical-solution">Numerical Solution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#linear-problem">Linear Problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="#log-uniform-problem">Log-Uniform Problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sensitivity-refinement">Sensitivity Refinement</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api_VRM.html">API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../flow/index.html">Richards Equation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api_core/api_FiniteVolume.html">Finite Volume</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_core/api_ForwardProblem.html">Forward Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_core/api_InversionComponents.html">Inversion Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_core/api_Maps.html">Maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_core/api_Utilities.html">Utilities</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Meta Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../release/index.html">Release Notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">SimPEG</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Viscous Remanent Magnetization</a> &raquo;</li>
        
      <li>Background Theory</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            <a href="https://github.com/simpeg/simpeg/edit/main/docs/content/vrm/background.rst" class="fa fa-github"> Edit on GitHub</a>
        
      </li>
    
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="background-theory">
<h1>Background Theory<a class="headerlink" href="#background-theory" title="Permalink to this headline">¶</a></h1>
<p><strong>The background theory presented here is copied entirely from the Master’s thesis “Forward modeling and inversion of viscous remanent magnetization responses in the time domain” (Cowan, 2016). See this thesis for a more thorough treatment of the background theory.</strong></p>
<section id="general">
<h2>General<a class="headerlink" href="#general" title="Permalink to this headline">¶</a></h2>
<p>To first order, and during the off-time, the Earth’s inductive and viscous remanent magnetization (VRM) responses are separable so long as the Earth’s magnetic susceptibility
is sufficiently small (Druyts et al., 2009); i.e. <span class="math notranslate nohighlight">\(\chi &lt; 0.1\)</span>. This was first postulated by Buselli (1982);
who used various SiroTEM configurations to perform field experiments. The approximation was later validated
numerically by Pasion (2007), among others. At early times, the response is equivalent to that of a purely conductive
Earth (red); at late times, the response is equivalent to that of a purely viscous Earth (purple). By summing
the responses from these two models, the response from a conductive and magnetically viscous Earth can be approximated. Thus:</p>
<div class="math notranslate nohighlight">
\[\vec{b}(t) = \vec{b}_{em}(t) + \vec{b}_{vrm}(t)\]</div>
<figure class="align-center" id="id1">
<a class="reference internal image-reference" href="../../_images/em_vrm_decouple.png"><img alt="../../_images/em_vrm_decouple.png" src="../../_images/em_vrm_decouple.png" style="width: 700px;" /></a>
<figcaption>
<p><span class="caption-text">Vertical step-off response from a horizontal circular current loop over a conductive and magnetically viscous halfspace. (a) <span class="math notranslate nohighlight">\(b_z\)</span>. (b) <span class="math notranslate nohighlight">\(\partial b_z/\partial t\)</span>.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>Here, we develop a methodology for modeling <span class="math notranslate nohighlight">\(\mathbf{b_{vrm}}\)</span>; as methodologies currently exist for modeling <span class="math notranslate nohighlight">\(\mathbf{b_{em}}\)</span>. According
to Blakely (1996), the anomalous magnetic response <span class="math notranslate nohighlight">\(\vec{b} (P ,t)\)</span> at location <span class="math notranslate nohighlight">\(P\)</span> outside of a magnetized region is given by the following integral equation:</p>
<div class="math notranslate nohighlight" id="vrm-blakely">
<span id="equation-vrm-blakely"></span><span class="eqno">(1)<a class="headerlink" href="#vrm-blakely" title="Permalink to this equation">¶</a></span>\[\vec{b}(P,t) = \frac{\mu_0}{4\pi} \int_{V} \nabla \nabla \frac{1}{r} \cdot \vec{M} (Q , t) dV\]</div>
<p>where <span class="math notranslate nohighlight">\(\vec{M} (Q,t)\)</span> is the magnetization at locations <span class="math notranslate nohighlight">\(Q\)</span> within the source region <span class="math notranslate nohighlight">\(V\)</span> and <span class="math notranslate nohighlight">\(r\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[r = \sqrt{\big ( x_P - x_Q \big )^2 + \big ( y_P - y_Q \big )^2 + \big ( z_P - z_Q \big )^2 }\]</div>
<p>SimPEG methods for modeling VRM responses in the time-domain are numerical solutions to the above equation.</p>
</section>
<section id="dispersive-magnetic-susceptibility">
<h2>Dispersive Magnetic Susceptibility<a class="headerlink" href="#dispersive-magnetic-susceptibility" title="Permalink to this headline">¶</a></h2>
<p>Magnetic susceptibility defines the degree of induced magnetization experienced by a material, proportional to the strength of an applied magnetic field. In magnetically viscous rocks/soils, the induced magnetization depends on the frequency of the applied field (Lee, 1984; Dabas et al., 1992; Fannin and Charles, 1995; Meglich et al., 2008), thus:</p>
<div class="math notranslate nohighlight">
\[\vec{M} (\omega )= \chi (\omega) \vec{H}_0 (\omega)\]</div>
<p>where <span class="math notranslate nohighlight">\(\vec M\)</span> is the magnetization, <span class="math notranslate nohighlight">\(\vec{H}_0\)</span> is the applied magnetic field and <span class="math notranslate nohighlight">\(\chi\)</span> is a frequency-dependent magnetic susceptibility. Commonly used models for the frequency-dependent magnetic susceptibility are derived by applying a weighting function <span class="math notranslate nohighlight">\(f(\tau )\)</span> and integrating over all Debye models:</p>
<div class="math notranslate nohighlight">
\[\chi (\omega) = \chi_\infty + \Delta \chi \int_0^\infty \frac{f (\tau )}{1 +i \omega\tau} d\tau\]</div>
<p>where <span class="math notranslate nohighlight">\(\tau\)</span> is the time-relaxation constant, <span class="math notranslate nohighlight">\(\chi_\infty\)</span> is the instantaneous magnetic susceptibility and <span class="math notranslate nohighlight">\(\Delta \chi\)</span> is the DC contribution due to magnetic viscosity.</p>
<figure class="align-center" id="id2">
<a class="reference internal image-reference" href="../../_images/chi_dispersive.png"><img alt="../../_images/chi_dispersive.png" src="../../_images/chi_dispersive.png" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-text">Frequency-dependent magnetic susceptibility assuming various distributions of time-relaxation constants.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>As we can see, the magnetic viscosity is defined by the choice in weighting function. The majority of soil samples can be adequately fit by assuming a log-uniform distribution of time relaxation constants between
a set of finite limits <span class="math notranslate nohighlight">\(\tau_1\)</span> and <span class="math notranslate nohighlight">\(\tau_2\)</span> (Dabas et al., 1992; Worm, 1998; Igel et al., 2012). This leads to a magnetic susceptibility of the form:</p>
<div class="math notranslate nohighlight">
\[\chi (\omega) = \chi_\infty + \Delta \chi \Bigg [ 1 - \frac{1}{\textrm{ln} (\tau_2 / \tau_1) } \textrm{ln} \Bigg ( \frac{1 + i\omega\tau_2}{1 + i\omega\tau_1} \Bigg ) \Bigg ]\]</div>
<p>In the time-domain, the relationship between the applied magnetic field and the resulting magnetization becomes a convolution:</p>
<div class="math notranslate nohighlight" id="vrm-magnetization">
<span id="equation-vrm-magnetization"></span><span class="eqno">(2)<a class="headerlink" href="#vrm-magnetization" title="Permalink to this equation">¶</a></span>\[\vec{M}(t) = \chi (t) \otimes \vec{h}_0 (t) = \int_{-\infty}^\infty \chi (\xi) \vec{h}_0 (t - \xi) d\xi\]</div>
<p>where <span class="math notranslate nohighlight">\(\vec M (t)\)</span> is the induced magnetization, <span class="math notranslate nohighlight">\(\vec{h}_0 (t)\)</span> is the applied magnetic field, and <span class="math notranslate nohighlight">\(\chi (t)\)</span> represents the magnetization’s impulse response. For a log-uniform distribution of time-relaxation constants, this is given by:</p>
<div class="math notranslate nohighlight" id="vrm-impulse">
<span id="equation-vrm-impulse"></span><span class="eqno">(3)<a class="headerlink" href="#vrm-impulse" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{align}
\chi (t) &amp; = \chi_\infty \delta (t) + \Delta \chi \, u(t) \int_0^\infty f(\tau) \frac{e^{-t/\!\tau}}{\tau} d\tau \\
&amp; = \chi_\infty \delta (t) + \frac{\Delta \chi}{\textrm{ln} (\tau_2 / \tau_2)} \Bigg [ \frac{e^{-t/\!\tau_2} - e^{-t/\!\tau_2}}{t} \Bigg ] \, u(t)
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(u(t)\)</span> is the unit step function and <span class="math notranslate nohighlight">\(\delta (t)\)</span> is the Dirac delta function. In the previous equation, the first term characterizes instantaneous magnetization and the second term characterizes magnetic viscosity.</p>
<figure class="align-center" id="id3">
<a class="reference internal image-reference" href="../../_images/impulse_response.png"><img alt="../../_images/impulse_response.png" src="../../_images/impulse_response.png" style="width: 400px;" /></a>
<figcaption>
<p><span class="caption-text">General shape of the impulse response.</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="numerical-solution">
<h2>Numerical Solution<a class="headerlink" href="#numerical-solution" title="Permalink to this headline">¶</a></h2>
<p>The anomalous magnetic response outside of a magnetized region is given by Eq. <a class="reference internal" href="#equation-vrm-blakely">(1)</a>. Assuming the magnetic response is the result of a set of uniformly magnetized rectangular cells, Eq. <a class="reference internal" href="#equation-vrm-blakely">(1)</a> is approximated by the following (Bhattacharyya, 1964; Varga, 1996):</p>
<div class="math notranslate nohighlight" id="vrm-varga">
<span id="equation-vrm-varga"></span><span class="eqno">(4)<a class="headerlink" href="#vrm-varga" title="Permalink to this equation">¶</a></span>\[\vec{b} (P , t) = \sum_{k=1}^K G^k \cdot \vec{M}^k (t)\]</div>
<p>where <span class="math notranslate nohighlight">\(\vec{b} (P , t)\)</span> is the time-dependent magnetization observed at <span class="math notranslate nohighlight">\(P\)</span>, <span class="math notranslate nohighlight">\(\vec{M} (t)\)</span> contains the vector components of induced magnetization within each cell <span class="math notranslate nohighlight">\(k\)</span> at time <span class="math notranslate nohighlight">\(t\)</span> and <span class="math notranslate nohighlight">\(G\)</span> are <span class="math notranslate nohighlight">\(3 \times 3\)</span> tensors representing a linear operator between the magnetization of the cell <span class="math notranslate nohighlight">\(k\)</span> and the anomalous magnetic response at location <span class="math notranslate nohighlight">\(P\)</span>. Thus <span class="math notranslate nohighlight">\(\vec{b} (P , t)\)</span>, <span class="math notranslate nohighlight">\(G\)</span> and <span class="math notranslate nohighlight">\(\vec{M} (t)\)</span> are given by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vec{b} (P , t) = \begin{bmatrix} b_x (P,t) \\ b_y (P,t) \\ b_z (P,t) \end{bmatrix} \;\; , \;\;
\vec{M} (t) = \begin{bmatrix} M_x (t) \\ M_y (t) \\ M_z (t) \end{bmatrix} \;\; \textrm{and} \;\;
G = \begin{bmatrix} g_{xx} &amp; g_{xy} &amp; g_{xz} \\ g_{yx} &amp; g_{yy} &amp; g_{yz} \\ g_{zx} &amp; g_{zy} &amp; g_{zz} \end{bmatrix}\end{split}\]</div>
<p>Eq. <a class="reference internal" href="#equation-vrm-varga">(4)</a> can be re-expressed as a linear system. And in the case that there are multiple observation locations, this system may be augmented and expressed as:</p>
<div class="math notranslate nohighlight" id="vrm-system">
<span id="equation-vrm-system"></span><span class="eqno">(5)<a class="headerlink" href="#vrm-system" title="Permalink to this equation">¶</a></span>\[\mathbf{b}(t) = \mathbf{G} \, \vec{\mathbf{M}}(t)\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{b}(t)\)</span>, <span class="math notranslate nohighlight">\(\vec{\mathbf{M}}(t)\)</span> and <span class="math notranslate nohighlight">\(\mathbf{G}\)</span> take the form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{b}(t) = \begin{bmatrix} \mathbf{b_x}(t) \\ \mathbf{b_y}(t) \\ \mathbf{b_z}(t) \end{bmatrix} \;\; , \;\;
\vec{\mathbf{M}} (t) = \begin{bmatrix} \mathbf{M_x}(t) \\ \mathbf{M_y}(t) \\ \mathbf{M_z}(t) \end{bmatrix} \;\; \textrm{and} \;\;
\mathbf{G} = \begin{bmatrix} G_{xx} &amp; G_{xy} &amp; G_{xz} \\ G_{yx} &amp; G_{yy} &amp; G_{yz} \\ G_{zx} &amp; G_{zy} &amp; G_{zz} \end{bmatrix}\end{split}\]</div>
<p>Thus <span class="math notranslate nohighlight">\(\mathbf{b}(t)\)</span> contains the cartesian components of the magnetic response at all observation locations, <span class="math notranslate nohighlight">\(\vec{\mathbf{M}}(t)\)</span> contains the cartesian components of induced magnetization within all of the cells at time <span class="math notranslate nohighlight">\(t\)</span> and <span class="math notranslate nohighlight">\(\mathbf{G}\)</span> is a linear operator. The time-derivative of the response is given by:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial  \mathbf{b}}{\partial t} = \mathbf{G} \, \frac{\partial \vec{\mathbf{M}} }{\partial t}\]</div>
<p>The magnetization experienced by each cell <span class="math notranslate nohighlight">\(k\)</span> is given by the following convolution:</p>
<div class="math notranslate nohighlight" id="vrm-mag-conv-cell">
<span id="equation-vrm-mag-conv-cell"></span><span class="eqno">(6)<a class="headerlink" href="#vrm-mag-conv-cell" title="Permalink to this equation">¶</a></span>\[\vec{M}^k (t) \approx \chi^k (t) \otimes \vec{h}_0^k (t)\]</div>
<p>where <span class="math notranslate nohighlight">\(\vec{h}_0^k (t)\)</span> is the free-space field at the center cell <span class="math notranslate nohighlight">\(k\)</span> due to an inductive source and <span class="math notranslate nohighlight">\(\chi^k (t)\)</span> is the impulse response for cell <span class="math notranslate nohighlight">\(k\)</span>. Here we assume 2 things:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>That the inducing field is approximately homogeneous throughout the cell</p></li>
<li><p>That because we are modeling a purely viscous Earth, attenuation of the primary and secondary signal are negligible</p></li>
</ol>
</div></blockquote>
<section id="linear-problem">
<h3>Linear Problem<a class="headerlink" href="#linear-problem" title="Permalink to this headline">¶</a></h3>
<p>The linear formulation allows for rapid computation of VRM responses during the off-time; see Cowan, (2016). Assuming the distribution of time-relaxation constants is sufficiently broad for a log-uniform distribution (i.e. <span class="math notranslate nohighlight">\(\tau_1 \ll t \ll \tau_2\)</span>), then the off-time VRM experienced by each cell is given by:</p>
<div class="math notranslate nohighlight" id="vrm-off-time">
<span id="equation-vrm-off-time"></span><span class="eqno">(7)<a class="headerlink" href="#vrm-off-time" title="Permalink to this equation">¶</a></span>\[\vec{M}^k (t) \approx m^k \, \vec{h}_{max}^k \, \eta (t)\]</div>
<p>where <span class="math notranslate nohighlight">\(\vec{h}_{max}^k\)</span> is the inducing field at its maximum amplitude, <span class="math notranslate nohighlight">\(\eta (t)\)</span> is a purely time-dependent function which defines the decay for any cell and <span class="math notranslate nohighlight">\(m\)</span> is an indirect measure of magnetic viscosity and is related to <span class="math notranslate nohighlight">\(\Delta \chi\)</span>, <span class="math notranslate nohighlight">\(\tau_1\)</span> and <span class="math notranslate nohighlight">\(\tau_2\)</span> by:</p>
<div class="math notranslate nohighlight">
\[m = \frac{\Delta \chi}{ \textrm{ln} (\tau_2 / \tau_1)}\]</div>
<p>Using Eq. <a class="reference internal" href="#equation-vrm-off-time">(7)</a>, <span class="math notranslate nohighlight">\(\vec{\mathbf{M}}(t)\)</span> in Eq. <a class="reference internal" href="#equation-vrm-system">(5)</a> becomes:</p>
<div class="math notranslate nohighlight" id="vrm-mag-lin">
<span id="equation-vrm-mag-lin"></span><span class="eqno">(8)<a class="headerlink" href="#vrm-mag-lin" title="Permalink to this equation">¶</a></span>\[\vec{\mathbf{M}}(t) = \eta (t) \, \mathbf{H_0 \, m}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{H_0}\)</span> is a sparse matrix containing the cartesian components of <span class="math notranslate nohighlight">\(\vec{h}_{max}^k\)</span> for every cell and <span class="math notranslate nohighlight">\(\mathbf{m}\)</span> contains the parameter <span class="math notranslate nohighlight">\(m^k\)</span> for every cell. Substituting Eq. <a class="reference internal" href="#equation-vrm-mag-lin">(8)</a> into Eq. <a class="reference internal" href="#equation-vrm-system">(5)</a>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{b}(t) &amp;= \eta (t) \mathbf{G \, H_0 \, m} \\
&amp; = \eta (t) \mathbf{A \, m}
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is a dense linear operator containing the geometric sensitivity and</p>
<div class="math notranslate nohighlight">
\[\frac{\partial \mathbf{b}}{\partial t} = \frac{d \eta}{dt} \mathbf{A \, m}\]</div>
<p>In the case that the predicted data vector <span class="math notranslate nohighlight">\(\mathbb{F} [\mathbf{m}]\)</span> contains field observations at multiple times and locations, <span class="math notranslate nohighlight">\(\eta\)</span> evaluated at different times can be used to construct a sparse matrix <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> such that:</p>
<div class="math notranslate nohighlight" id="vrm-fwd-lin">
<span id="equation-vrm-fwd-lin"></span><span class="eqno">(9)<a class="headerlink" href="#vrm-fwd-lin" title="Permalink to this equation">¶</a></span>\[\mathbb{F} [\mathbf{m}] = \mathbf{T \, A \, m}\]</div>
<p>Although this problem is linear, storing the product of <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> can become prohibitively large as the number of observation times increases. As a result, the two operators are stored separately and matrix-vector products are taken as needed.</p>
<p>The Jacobian is given by:</p>
<div class="math notranslate nohighlight">
\[\mathbf{J} = \mathbf{T \, A}\]</div>
<p>however it is never stored explicitly. Instead, optimization approach need only compute the output of <span class="math notranslate nohighlight">\(\mathbf{Ju}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{J^T v}\)</span> where <span class="math notranslate nohighlight">\(\mathbf{u}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{v}\)</span> are vectors.</p>
</section>
<section id="log-uniform-problem">
<h3>Log-Uniform Problem<a class="headerlink" href="#log-uniform-problem" title="Permalink to this headline">¶</a></h3>
<p>The general forward problem is non-linear, as the VRM does not decay in the same fashion within all cells. In this case however, we are not limited to computing the magnetic response during the off-time. The magnetization experienced by each cells is given by Eq. <a class="reference internal" href="#equation-vrm-mag-conv-cell">(6)</a>. However since the geometric and time-dependent terms are separable, this can be re-expressed as:</p>
<div class="math notranslate nohighlight" id="vrm-all-time">
<span id="equation-vrm-all-time"></span><span class="eqno">(10)<a class="headerlink" href="#vrm-all-time" title="Permalink to this equation">¶</a></span>\[\vec{M}^k (t) = \vec{h}_{max}^k \, \zeta^k\]</div>
<p>where <span class="math notranslate nohighlight">\(\vec{h}_{max}^k\)</span> is the inducing field at its maximum amplitude and <span class="math notranslate nohighlight">\(\zeta^k\)</span> is the impulse response convolved with the normalized source waveform; <span class="math notranslate nohighlight">\(\zeta\)</span> depends on <span class="math notranslate nohighlight">\(t\)</span> and the values of <span class="math notranslate nohighlight">\(\chi_\infty, \Delta \chi, \tau_1\)</span> and <span class="math notranslate nohighlight">\(\tau_2\)</span> for each cell. Using Eq. <a class="reference internal" href="#equation-vrm-all-time">(10)</a>, <span class="math notranslate nohighlight">\(\vec{\mathbf{M}}(t)\)</span> in Eq. <a class="reference internal" href="#equation-vrm-system">(5)</a> becomes:</p>
<div class="math notranslate nohighlight" id="vrm-mag-nonlin">
<span id="equation-vrm-mag-nonlin"></span><span class="eqno">(11)<a class="headerlink" href="#vrm-mag-nonlin" title="Permalink to this equation">¶</a></span>\[\vec{\mathbf{M}}(t) = \mathbf{H_0 \,} \boldsymbol{ \zeta}(t)\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{H_0}\)</span> is a sparse matrix containing the cartesian components of <span class="math notranslate nohighlight">\(\vec{h}_{max}^k\)</span> for every cell and <span class="math notranslate nohighlight">\(\boldsymbol{\zeta}(t)\)</span> contains the results of a convolution for every cell at time <span class="math notranslate nohighlight">\(t\)</span>. Substituting Eq. <a class="reference internal" href="#equation-vrm-mag-nonlin">(11)</a> into Eq. <a class="reference internal" href="#equation-vrm-system">(5)</a>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{b}(t) &amp;= \mathbf{G \, H_0 \,} \boldsymbol{\zeta} (t) \\
&amp; = \mathbf{A \,} \boldsymbol{\zeta} (t)
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is a dense linear operator containing the geometric sensitivity and</p>
<div class="math notranslate nohighlight">
\[\frac{\partial \mathbf{b}}{\partial t} = \mathbf{A \,} \frac{\partial \boldsymbol{\zeta}}{\partial t}\]</div>
<p>Because the problem is non-linear with respect to parameters <span class="math notranslate nohighlight">\(\chi_\infty, \Delta \chi, \tau_1\)</span> and <span class="math notranslate nohighlight">\(\tau_2\)</span>, the predicted data vector <span class="math notranslate nohighlight">\(\mathbb{F}[\mathbf{m}]\)</span> must be computed using a for loop if the number of observation times is larger than 1.</p>
</section>
<section id="sensitivity-refinement">
<h3>Sensitivity Refinement<a class="headerlink" href="#sensitivity-refinement" title="Permalink to this headline">¶</a></h3>
<p>The formulation described here assumes that the inducing field is approximately homogeneous within each cell. In the case where cells are located in close proximity to an inductive source, this condition is violated. To remedy the issue, a geometric sensitivity refinement algorithm was developed. The algorithm locates cells within a certain distance of the source, recomputes the sensitivities assuming the cell is defined by <span class="math notranslate nohighlight">\(2^{3n}\)</span> smaller cells, then replaces the appropriate columns in <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>. For further reading, see Cowan (2016)</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Viscous Remanent Magnetization" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="api_VRM.html" class="btn btn-neutral float-right" title="API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  

 


    <div id="disqus_thread"></div>
    <script>

    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/

    var disqus_config = function () {
    this.page.url = {path};  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = {path}; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };

    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://simpeg.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


    <div role="contentinfo">
        <a rel="license" href="http://creativecommons.org/licenses/by/4.0/" width="60px"; style="float:right;height:3em;line-height:3em;padding:10px 0 0 1em;">
            <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" />
        </a>
        2013-2018,
        <a href="http://simpeg.xyz">SimPEG Developers.</a><br />
        Except where noted, this work is licensed under a <br />
        <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
            Creative Commons Attribution 4.0 International License
        </a>
    </div>
    <br>
    <div>
    Built with
        <a href="http://sphinx-doc.org/">Sphinx</a>
        using a
        <a href="https://github.com/snide/sphinx_rtd_theme">theme</a>
        provided by
        <a href="https://readthedocs.org">Read the Docs</a>.
     </div>


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>